on: [push, fork]

jobs:
  Espresso:
    runs-on: ubuntu-latest
    strategy:
      matrix:
        recipe_uuid:
          - e104f058-b291-4764-8e0d-d9ff78a41192 # Android 11
          - 70eaaf75-bd9a-406d-9f01-682a5d400c6e # Android 10
    name: Run Espresso Tests
    steps:
      - name: Checkout
        uses: actions/checkout@v3

      - uses: actions/setup-python@v4
        with:
          python-version: "3.10.11"

      - name: Set up JDK 17
        uses: actions/setup-java@v3
        with:
          java-version: "17"
          distribution: "temurin"

      - name: Setup Android SDK
        uses: android-actions/setup-android@v2

      - name: Genymotion
        uses: genymobile/genymotion-saas-github-action@v0.4
        with:
          email: ${{ secrets.GMSAAS_EMAIL }}
          password: ${{ secrets.GMSAAS_PASSWORD }}
          recipe_uuid: ${{ matrix.recipe_uuid }}
      
      - name: Run Espresso Tests
        run: ./gradlew cAT


